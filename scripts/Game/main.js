import {
  Camera,
  Color,
  Component,
  Convex,
  Keyboard,
  Mouse,
  RenderComponent,
  RigidbodyComponent,
  Runtime_default,
  ShapeRendererComponent,
  TileMap,
  TileRendererComponent,
  Vector2,
  __name,
  lerp
} from "../chunk-KOJFVHTC.js";

// src/Game/Components/CameraFollowComponent.ts
var CameraFollowComponent = class extends Component {
  defaults = {
    followSpeed: 0.8,
    threshold: 100
  };
  update({ followSpeed, threshold }, entity) {
    const speed = Camera.position.distance(entity.transform.position) / (threshold / Camera.zoom) * followSpeed;
    Camera.position = Camera.position.lerp(entity.transform.position, speed);
    if (Runtime_default.debug) {
      Runtime_default.canvas.vector(Camera.cameraToWorldSpace(new Vector2(50, 50).minus(Runtime_default.canvas.middle)), 0, Vector2.up.multiply(40).divide(Camera.zoom), Color.red);
    }
  }
};
__name(CameraFollowComponent, "CameraFollowComponent");

// src/Game/Components/FollowPlayerComponent.ts
var FollowPlayerComponent = class extends Component {
  dependencies = [RigidbodyComponent];
  defaults = {
    speed: 1,
    distance: 16
  };
  update(attributes, entity) {
    const player = Runtime_default.getEntity("player");
    const rigidbody = entity.getComponent(RigidbodyComponent);
    if (!player)
      throw new Error("No player entity found.");
    const distance = entity.transform.position.distance(player.transform.position);
    if (distance > attributes.distance)
      rigidbody.velocity = entity.transform.position.minus(player.transform.position).normalize().invert().multiply(attributes.speed).limit(attributes.distance);
  }
};
__name(FollowPlayerComponent, "FollowPlayerComponent");

// src/Game/Components/KeyboardControllerComponent.ts
var KeyboardControllerComponent = class extends Component {
  dependencies = [RigidbodyComponent];
  defaults = {
    speed: 1,
    sprintSpeed: 5,
    velocity: new Vector2()
  };
  update(attributes, entity) {
    const rigidbody = entity.getComponent(RigidbodyComponent);
    let { speed, sprintSpeed } = attributes;
    if (Keyboard.isDown("shift"))
      speed = sprintSpeed;
    let direction = Vector2.zero;
    if (Keyboard.isDown("s")) {
      direction = direction.add(Vector2.down);
    }
    if (Keyboard.isDown("w")) {
      direction = direction.add(Vector2.up);
    }
    if (Keyboard.isDown("a")) {
      direction = direction.add(Vector2.left);
    }
    if (Keyboard.isDown("d")) {
      direction = direction.add(Vector2.right);
    }
    direction = direction.rotate(-Camera.rotation);
    rigidbody.velocity = rigidbody.velocity.add(direction);
  }
};
__name(KeyboardControllerComponent, "KeyboardControllerComponent");

// src/Game/Components/MouseControllerComponent.ts
var MouseControllerComponent = class extends Component {
  dependencies = [RigidbodyComponent];
  defaults = {
    speed: 1
  };
  update(attributes, entity) {
    const { speed } = attributes;
    const rigidbody = entity.getComponent(RigidbodyComponent);
    attributes.speed = Mouse.right ? 7.5 : 2.5;
    if (Mouse.middle)
      attributes.speed = Mouse.position.minus(entity.transform.position).length;
    rigidbody.velocity = Mouse.position.minus(entity.transform.position).normalize().multiply(speed);
  }
};
__name(MouseControllerComponent, "MouseControllerComponent");

// src/Game/Components/RotateComponent.ts
var RotateComponent = class extends RenderComponent {
  defaults = {
    rotationSpeed: 1
  };
  render(attributes, entity) {
    entity.transform.rotation += attributes.rotationSpeed;
  }
};
__name(RotateComponent, "RotateComponent");

// src/Game/Components/ZoomComponent.ts
var ZoomComponent = class extends Component {
  defaults = {
    cameraRotation: 0,
    zoom: 1,
    zoomSpeed: 0.05
  };
  update(attributes) {
    if (Keyboard.isPressed("arrowright"))
      attributes.cameraRotation += 45;
    if (Keyboard.isPressed("arrowleft"))
      attributes.cameraRotation -= 45;
    attributes.zoom = lerp(attributes.zoom, Math.max(1, Math.min(Mouse.wheel + 1, 16)), 0.8);
    Camera.rotation = lerp(Camera.rotation, attributes.cameraRotation, 0.02);
    Camera.zoom = lerp(Camera.zoom, attributes.zoom, attributes.zoomSpeed);
  }
};
__name(ZoomComponent, "ZoomComponent");

// src/Game/main.ts
Runtime_default.registerComponent(MouseControllerComponent, KeyboardControllerComponent, FollowPlayerComponent, ZoomComponent, RotateComponent, CameraFollowComponent);
var shapes = [
  {
    offset: new Vector2(16, 16),
    rotation: 0,
    color: Color.red,
    type: "box",
    size: 32
  },
  {
    offset: new Vector2(-16, -16),
    rotation: 45,
    color: Color.red,
    type: "box",
    size: 32
  },
  {
    offset: new Vector2(16, -16),
    rotation: 0,
    color: Color.red,
    type: "circle",
    size: 32
  },
  {
    offset: new Vector2(-16, 16),
    rotation: 225,
    color: Color.red,
    type: "circle",
    size: 32,
    arc: [0, 180]
  }
];
var points = Convex.convertShapesToPoints(shapes);
async function start() {
  Runtime_default.canvas.background = Color.black;
  Camera.zoom = 4;
  const tileMap = await TileMap.load("assets/tilemap.png", { tileWidth: 16, tileHeight: 16 });
  const player = Runtime_default.createEntity("player");
  player.addComponent(TileRendererComponent, {
    tileMap,
    tile: [13, 14, 15]
  });
  player.addComponent([CameraFollowComponent, KeyboardControllerComponent, ZoomComponent]);
  const enemy = Runtime_default.createEntity("enemy");
  enemy.transform.position = Vector2.random.multiply(100);
  enemy.addComponent(ShapeRendererComponent, {
    shapes
  });
  Runtime_default.onUpdate(() => {
    Runtime_default.canvas.wirePolygon(enemy.transform.position.add(100, 0), 0, Color.green, points);
  });
  const circle = Runtime_default.createEntity("circle");
  circle.transform.position = Vector2.zero;
  circle.addComponent(ShapeRendererComponent, {
    shapes: [
      {
        type: "circle",
        size: 32,
        color: Color.blue,
        offset: new Vector2(0, 0),
        rotation: 180,
        arc: [0, 180]
      }
    ]
  });
  circle.addComponent(RotateComponent);
}
__name(start, "start");
start();
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL0dhbWUvQ29tcG9uZW50cy9DYW1lcmFGb2xsb3dDb21wb25lbnQudHMiLCAiLi4vLi4vLi4vc3JjL0dhbWUvQ29tcG9uZW50cy9Gb2xsb3dQbGF5ZXJDb21wb25lbnQudHMiLCAiLi4vLi4vLi4vc3JjL0dhbWUvQ29tcG9uZW50cy9LZXlib2FyZENvbnRyb2xsZXJDb21wb25lbnQudHMiLCAiLi4vLi4vLi4vc3JjL0dhbWUvQ29tcG9uZW50cy9Nb3VzZUNvbnRyb2xsZXJDb21wb25lbnQudHMiLCAiLi4vLi4vLi4vc3JjL0dhbWUvQ29tcG9uZW50cy9Sb3RhdGVDb21wb25lbnQudHMiLCAiLi4vLi4vLi4vc3JjL0dhbWUvQ29tcG9uZW50cy9ab29tQ29tcG9uZW50LnRzIiwgIi4uLy4uLy4uL3NyYy9HYW1lL21haW4udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCBDYW1lcmEgZnJvbSAnQC9SZW5kZXJlci9DYW1lcmEnO1xuaW1wb3J0IEdhbWUsIHsgQ29sb3IsIENvbXBvbmVudCwgRW50aXR5LCBWZWN0b3IyIH0gZnJvbSAnRW5naW5lJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FtZXJhRm9sbG93Q29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBvdmVycmlkZSBkZWZhdWx0cyA9IHtcbiAgICAgICAgZm9sbG93U3BlZWQ6IDAuOCxcbiAgICAgICAgdGhyZXNob2xkOiAxMDBcbiAgICB9O1xuXG5cbiAgICBvdmVycmlkZSB1cGRhdGUoeyBmb2xsb3dTcGVlZCwgdGhyZXNob2xkIH06IHRoaXNbJ2RlZmF1bHRzJ10sIGVudGl0eTogRW50aXR5KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNwZWVkID0gQ2FtZXJhLnBvc2l0aW9uLmRpc3RhbmNlKGVudGl0eS50cmFuc2Zvcm0ucG9zaXRpb24pIC8gKHRocmVzaG9sZCAvIENhbWVyYS56b29tKSAqIGZvbGxvd1NwZWVkO1xuXG4gICAgICAgIENhbWVyYS5wb3NpdGlvbiA9IENhbWVyYS5wb3NpdGlvbi5sZXJwKGVudGl0eS50cmFuc2Zvcm0ucG9zaXRpb24sIHNwZWVkKTtcblxuICAgICAgICBpZiAoR2FtZS5kZWJ1Zykge1xuICAgICAgICAgICAgR2FtZS5jYW52YXMudmVjdG9yKFxuICAgICAgICAgICAgICAgIENhbWVyYS5jYW1lcmFUb1dvcmxkU3BhY2UoXG4gICAgICAgICAgICAgICAgICAgIG5ldyBWZWN0b3IyKDUwLCA1MCkubWludXMoR2FtZS5jYW52YXMubWlkZGxlKVxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICBWZWN0b3IyLnVwLm11bHRpcGx5KDQwKS5kaXZpZGUoQ2FtZXJhLnpvb20pLFxuICAgICAgICAgICAgICAgIENvbG9yLnJlZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgUmlnaWRib2R5Q29tcG9uZW50IGZyb20gJ0AvQ29tcG9uZW50cy9SaWdpZGJvZHlDb21wb25lbnQnO1xuaW1wb3J0IEdhbWUsIHsgQ29tcG9uZW50LCBFbnRpdHksIFZlY3RvcjIgfSBmcm9tICdFbmdpbmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb2xsb3dQbGF5ZXJDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIG92ZXJyaWRlIHJlYWRvbmx5IGRlcGVuZGVuY2llcyA9IFtSaWdpZGJvZHlDb21wb25lbnRdO1xuXG4gICAgb3ZlcnJpZGUgZGVmYXVsdHMgPSB7XG4gICAgICAgIHNwZWVkOiAxLFxuICAgICAgICBkaXN0YW5jZTogMTZcbiAgICB9O1xuXG4gICAgb3ZlcnJpZGUgdXBkYXRlKGF0dHJpYnV0ZXM6IHRoaXNbJ2RlZmF1bHRzJ10sIGVudGl0eTogRW50aXR5KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHBsYXllciA9IEdhbWUuZ2V0RW50aXR5KFwicGxheWVyXCIpO1xuICAgICAgICBjb25zdCByaWdpZGJvZHkgPSBlbnRpdHkuZ2V0Q29tcG9uZW50KFJpZ2lkYm9keUNvbXBvbmVudCk7XG5cbiAgICAgICAgaWYgKCFwbGF5ZXIpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBwbGF5ZXIgZW50aXR5IGZvdW5kLlwiKTtcblxuICAgICAgICBjb25zdCBkaXN0YW5jZSA9IGVudGl0eS50cmFuc2Zvcm0ucG9zaXRpb24uZGlzdGFuY2UocGxheWVyLnRyYW5zZm9ybS5wb3NpdGlvbik7XG5cbiAgICAgICAgaWYgKGRpc3RhbmNlID4gYXR0cmlidXRlcy5kaXN0YW5jZSlcbiAgICAgICAgICAgIHJpZ2lkYm9keS52ZWxvY2l0eSA9IGVudGl0eS50cmFuc2Zvcm0ucG9zaXRpb24ubWludXMocGxheWVyLnRyYW5zZm9ybS5wb3NpdGlvbikubm9ybWFsaXplKCkuaW52ZXJ0KCkubXVsdGlwbHkoYXR0cmlidXRlcy5zcGVlZCkubGltaXQoYXR0cmlidXRlcy5kaXN0YW5jZSk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBDYW1lcmEgfSBmcm9tICdAL1JlbmRlcmVyJztcbmltcG9ydCBSaWdpZGJvZHlDb21wb25lbnQgZnJvbSAnQC9Db21wb25lbnRzL1JpZ2lkYm9keUNvbXBvbmVudCc7XG5pbXBvcnQgR2FtZSwgeyBDb21wb25lbnQsIEVudGl0eSwgS2V5Ym9hcmQsIFZlY3RvcjIgfSBmcm9tICdFbmdpbmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLZXlib2FyZENvbnRyb2xsZXJDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgb3ZlcnJpZGUgcmVhZG9ubHkgZGVwZW5kZW5jaWVzID0gW1JpZ2lkYm9keUNvbXBvbmVudF07XG5cbiAgICBvdmVycmlkZSBkZWZhdWx0cyA9IHtcbiAgICAgICAgc3BlZWQ6IDEsXG4gICAgICAgIHNwcmludFNwZWVkOiA1LFxuICAgICAgICB2ZWxvY2l0eTogbmV3IFZlY3RvcjIoKVxuICAgIH07XG5cbiAgICBvdmVycmlkZSB1cGRhdGUoYXR0cmlidXRlczogdGhpc1snZGVmYXVsdHMnXSwgZW50aXR5OiBFbnRpdHkpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmlnaWRib2R5ID0gZW50aXR5LmdldENvbXBvbmVudChSaWdpZGJvZHlDb21wb25lbnQpO1xuICAgICAgICBsZXQgeyBzcGVlZCwgc3ByaW50U3BlZWQgfSA9IGF0dHJpYnV0ZXM7XG5cbiAgICAgICAgaWYgKEtleWJvYXJkLmlzRG93bihcInNoaWZ0XCIpKVxuICAgICAgICAgICAgc3BlZWQgPSBzcHJpbnRTcGVlZDtcblxuICAgICAgICBsZXQgZGlyZWN0aW9uID0gVmVjdG9yMi56ZXJvO1xuICAgICAgICBpZiAoS2V5Ym9hcmQuaXNEb3duKFwic1wiKSkge1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gZGlyZWN0aW9uLmFkZChWZWN0b3IyLmRvd24pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEtleWJvYXJkLmlzRG93bihcIndcIikpIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IGRpcmVjdGlvbi5hZGQoVmVjdG9yMi51cCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoS2V5Ym9hcmQuaXNEb3duKFwiYVwiKSkge1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gZGlyZWN0aW9uLmFkZChWZWN0b3IyLmxlZnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEtleWJvYXJkLmlzRG93bihcImRcIikpIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IGRpcmVjdGlvbi5hZGQoVmVjdG9yMi5yaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICBkaXJlY3Rpb24gPSBkaXJlY3Rpb24ucm90YXRlKC1DYW1lcmEucm90YXRpb24pO1xuXG4gICAgICAgIHJpZ2lkYm9keS52ZWxvY2l0eSA9IHJpZ2lkYm9keS52ZWxvY2l0eS5hZGQoZGlyZWN0aW9uKTtcbiAgICB9XG5cbn0iLCAiaW1wb3J0IFJpZ2lkYm9keUNvbXBvbmVudCBmcm9tICdAL0NvbXBvbmVudHMvUmlnaWRib2R5Q29tcG9uZW50JztcbmltcG9ydCB7IENvbXBvbmVudCwgRW50aXR5LCBNb3VzZSwgVmVjdG9yMiB9IGZyb20gJ0VuZ2luZSc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW91c2VDb250cm9sbGVyQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIG92ZXJyaWRlIHJlYWRvbmx5IGRlcGVuZGVuY2llcyA9IFtSaWdpZGJvZHlDb21wb25lbnRdO1xuXG4gICAgb3ZlcnJpZGUgZGVmYXVsdHMgPSB7XG4gICAgICAgIHNwZWVkOiAxLFxuICAgIH07XG5cbiAgICBvdmVycmlkZSB1cGRhdGUoYXR0cmlidXRlczogdGhpc1snZGVmYXVsdHMnXSwgZW50aXR5OiBFbnRpdHkpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBzcGVlZCB9ID0gYXR0cmlidXRlcztcbiAgICAgICAgY29uc3QgcmlnaWRib2R5ID0gZW50aXR5LmdldENvbXBvbmVudChSaWdpZGJvZHlDb21wb25lbnQpXG5cbiAgICAgICAgYXR0cmlidXRlcy5zcGVlZCA9IE1vdXNlLnJpZ2h0ID8gNy41IDogMi41O1xuICAgICAgICBpZiAoTW91c2UubWlkZGxlKVxuICAgICAgICAgICAgYXR0cmlidXRlcy5zcGVlZCA9IE1vdXNlLnBvc2l0aW9uLm1pbnVzKGVudGl0eS50cmFuc2Zvcm0ucG9zaXRpb24pLmxlbmd0aDtcblxuICAgICAgICByaWdpZGJvZHkudmVsb2NpdHkgPSBNb3VzZS5wb3NpdGlvbi5taW51cyhlbnRpdHkudHJhbnNmb3JtLnBvc2l0aW9uKS5ub3JtYWxpemUoKS5tdWx0aXBseShzcGVlZCk7XG4gICAgfVxuXG59IiwgImltcG9ydCBSZW5kZXJDb21wb25lbnQgZnJvbSAnQC9Db21wb25lbnRzL1JlbmRlckNvbXBvbmVudCc7XG5pbXBvcnQgeyBFbnRpdHkgfSBmcm9tICdFbmdpbmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb3RhdGVDb21wb25lbnQgZXh0ZW5kcyBSZW5kZXJDb21wb25lbnQge1xuXG4gICAgb3ZlcnJpZGUgZGVmYXVsdHMgPSB7XG4gICAgICAgIHJvdGF0aW9uU3BlZWQ6IDFcbiAgICB9O1xuXG4gICAgb3ZlcnJpZGUgcmVuZGVyKGF0dHJpYnV0ZXM6IHRoaXNbXCJkZWZhdWx0c1wiXSwgZW50aXR5OiBFbnRpdHkpIHtcbiAgICAgICAgZW50aXR5LnRyYW5zZm9ybS5yb3RhdGlvbiArPSBhdHRyaWJ1dGVzLnJvdGF0aW9uU3BlZWQ7XG4gICAgfVxuXG59IiwgImltcG9ydCB7IENhbWVyYSB9IGZyb20gJ0AvUmVuZGVyZXInO1xuaW1wb3J0IHsgbGVycCB9IGZyb20gJ0AvSGVscGVycyc7XG5pbXBvcnQgR2FtZSwgeyBDb2xvciwgQ29tcG9uZW50LCBLZXlib2FyZCwgTW91c2UsIFZlY3RvcjIgfSBmcm9tICdFbmdpbmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBab29tQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIG92ZXJyaWRlIGRlZmF1bHRzID0ge1xuICAgICAgICBjYW1lcmFSb3RhdGlvbjogMCxcbiAgICAgICAgem9vbTogMSxcbiAgICAgICAgem9vbVNwZWVkOiAwLjA1XG4gICAgfTtcblxuICAgIG92ZXJyaWRlIHVwZGF0ZShhdHRyaWJ1dGVzOiB0aGlzW1wiZGVmYXVsdHNcIl0pIHtcbiAgICAgICAgaWYgKEtleWJvYXJkLmlzUHJlc3NlZChcImFycm93cmlnaHRcIikpXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNhbWVyYVJvdGF0aW9uICs9IDQ1O1xuXG4gICAgICAgIGlmIChLZXlib2FyZC5pc1ByZXNzZWQoXCJhcnJvd2xlZnRcIikpXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNhbWVyYVJvdGF0aW9uIC09IDQ1O1xuICAgICAgICBhdHRyaWJ1dGVzLnpvb20gPSBsZXJwKGF0dHJpYnV0ZXMuem9vbSwgTWF0aC5tYXgoMSwgTWF0aC5taW4oTW91c2Uud2hlZWwgKyAxLCAxNikpLCAwLjgpO1xuXG4gICAgICAgIENhbWVyYS5yb3RhdGlvbiA9IGxlcnAoQ2FtZXJhLnJvdGF0aW9uLCBhdHRyaWJ1dGVzLmNhbWVyYVJvdGF0aW9uLCAwLjAyKTtcbiAgICAgICAgQ2FtZXJhLnpvb20gPSBsZXJwKENhbWVyYS56b29tLCBhdHRyaWJ1dGVzLnpvb20sIGF0dHJpYnV0ZXMuem9vbVNwZWVkKTtcbiAgICB9XG5cbn0iLCAiaW1wb3J0IHsgQ2FtZXJhIH0gZnJvbSAnQC9SZW5kZXJlcic7XG5pbXBvcnQgU2hhcGVSZW5kZXJlckNvbXBvbmVudCBmcm9tICdAL0NvbXBvbmVudHMvU2hhcGVSZW5kZXJlckNvbXBvbmVudCc7XG5pbXBvcnQgVGlsZVJlbmRlcmVyQ29tcG9uZW50IGZyb20gJ0AvQ29tcG9uZW50cy9UaWxlUmVuZGVyZXJDb21wb25lbnQnO1xuaW1wb3J0IHR5cGUgeyBTaGFwZSB9IGZyb20gJ0AvUmVuZGVyZXInO1xuaW1wb3J0IEdhbWUsIHsgQ29sb3IsIEVudGl0eSwgTW91c2UsIFRpbGVtYXAsIFZlY3RvcjIgfSBmcm9tICdFbmdpbmUnO1xuaW1wb3J0IENhbWVyYUZvbGxvd0NvbXBvbmVudCBmcm9tICcuL0NvbXBvbmVudHMvQ2FtZXJhRm9sbG93Q29tcG9uZW50JztcbmltcG9ydCBGb2xsb3dQbGF5ZXJDb21wb25lbnQgZnJvbSAnLi9Db21wb25lbnRzL0ZvbGxvd1BsYXllckNvbXBvbmVudCc7XG5pbXBvcnQgS2V5Ym9hcmRDb250cm9sbGVyQ29tcG9uZW50IGZyb20gJy4vQ29tcG9uZW50cy9LZXlib2FyZENvbnRyb2xsZXJDb21wb25lbnQnO1xuaW1wb3J0IE1vdXNlQ29udHJvbGxlckNvbXBvbmVudCBmcm9tICcuL0NvbXBvbmVudHMvTW91c2VDb250cm9sbGVyQ29tcG9uZW50JztcbmltcG9ydCBSb3RhdGVDb21wb25lbnQgZnJvbSAnLi9Db21wb25lbnRzL1JvdGF0ZUNvbXBvbmVudCc7XG5pbXBvcnQgWm9vbUNvbXBvbmVudCBmcm9tICcuL0NvbXBvbmVudHMvWm9vbUNvbXBvbmVudCc7XG5pbXBvcnQgQ29udmV4IGZyb20gJ0AvUmVuZGVyZXIvQ29udmV4JztcblxuR2FtZS5yZWdpc3RlckNvbXBvbmVudChcbiAgICBNb3VzZUNvbnRyb2xsZXJDb21wb25lbnQsXG4gICAgS2V5Ym9hcmRDb250cm9sbGVyQ29tcG9uZW50LFxuICAgIEZvbGxvd1BsYXllckNvbXBvbmVudCxcbiAgICBab29tQ29tcG9uZW50LFxuICAgIFJvdGF0ZUNvbXBvbmVudCxcbiAgICBDYW1lcmFGb2xsb3dDb21wb25lbnRcbik7XG5jb25zdCBzaGFwZXM6IFNoYXBlW10gPSBbXG4gICAge1xuICAgICAgICBvZmZzZXQ6IG5ldyBWZWN0b3IyKDE2LCAxNiksXG4gICAgICAgIHJvdGF0aW9uOiAwLFxuICAgICAgICBjb2xvcjogQ29sb3IucmVkLFxuICAgICAgICB0eXBlOiBcImJveFwiLFxuICAgICAgICBzaXplOiAzMlxuICAgIH0sXG4gICAge1xuICAgICAgICBvZmZzZXQ6IG5ldyBWZWN0b3IyKC0xNiwgLTE2KSxcbiAgICAgICAgcm90YXRpb246IDQ1LFxuICAgICAgICBjb2xvcjogQ29sb3IucmVkLFxuICAgICAgICB0eXBlOiBcImJveFwiLFxuICAgICAgICBzaXplOiAzMlxuICAgIH0sXG4gICAge1xuICAgICAgICBvZmZzZXQ6IG5ldyBWZWN0b3IyKDE2LCAtMTYpLFxuICAgICAgICByb3RhdGlvbjogMCxcbiAgICAgICAgY29sb3I6IENvbG9yLnJlZCxcbiAgICAgICAgdHlwZTogXCJjaXJjbGVcIixcbiAgICAgICAgc2l6ZTogMzJcbiAgICB9LFxuICAgIHtcbiAgICAgICAgb2Zmc2V0OiBuZXcgVmVjdG9yMigtMTYsIDE2KSxcbiAgICAgICAgcm90YXRpb246IDIyNSxcbiAgICAgICAgY29sb3I6IENvbG9yLnJlZCxcbiAgICAgICAgdHlwZTogXCJjaXJjbGVcIixcbiAgICAgICAgc2l6ZTogMzIsXG4gICAgICAgIGFyYzogWzAsIDE4MF1cbiAgICB9XG5dO1xuXG5jb25zdCBwb2ludHMgPSBDb252ZXguY29udmVydFNoYXBlc1RvUG9pbnRzKHNoYXBlcyk7XG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgIEdhbWUuY2FudmFzLmJhY2tncm91bmQgPSBDb2xvci5ibGFjaztcbiAgICBDYW1lcmEuem9vbSA9IDQ7XG5cblxuICAgIGNvbnN0IHRpbGVNYXAgPSBhd2FpdCBUaWxlbWFwLmxvYWQoXCJhc3NldHMvdGlsZW1hcC5wbmdcIiwgeyB0aWxlV2lkdGg6IDE2LCB0aWxlSGVpZ2h0OiAxNiB9KTtcblxuICAgIGNvbnN0IHBsYXllciA9IEdhbWUuY3JlYXRlRW50aXR5KFwicGxheWVyXCIpO1xuXG4gICAgcGxheWVyLmFkZENvbXBvbmVudChUaWxlUmVuZGVyZXJDb21wb25lbnQsIHtcbiAgICAgICAgdGlsZU1hcCxcbiAgICAgICAgdGlsZTogWzEzLCAxNCwgMTVdXG4gICAgfSk7XG4gICAgcGxheWVyLmFkZENvbXBvbmVudChbQ2FtZXJhRm9sbG93Q29tcG9uZW50LCBLZXlib2FyZENvbnRyb2xsZXJDb21wb25lbnQsIFpvb21Db21wb25lbnRdKTtcblxuXG4gICAgY29uc3QgZW5lbXkgPSBHYW1lLmNyZWF0ZUVudGl0eShcImVuZW15XCIpO1xuICAgIGVuZW15LnRyYW5zZm9ybS5wb3NpdGlvbiA9IFZlY3RvcjIucmFuZG9tLm11bHRpcGx5KDEwMCk7XG4gICAgZW5lbXkuYWRkQ29tcG9uZW50KFNoYXBlUmVuZGVyZXJDb21wb25lbnQsIHtcbiAgICAgICAgc2hhcGVzXG4gICAgfSk7XG5cbiAgICBHYW1lLm9uVXBkYXRlKCgpID0+IHtcbiAgICAgICAgR2FtZS5jYW52YXMud2lyZVBvbHlnb24oZW5lbXkudHJhbnNmb3JtLnBvc2l0aW9uLmFkZCgxMDAsIDApLCAwLCBDb2xvci5ncmVlbiwgcG9pbnRzKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGNpcmNsZSA9IEdhbWUuY3JlYXRlRW50aXR5KFwiY2lyY2xlXCIpO1xuICAgIGNpcmNsZS50cmFuc2Zvcm0ucG9zaXRpb24gPSBWZWN0b3IyLnplcm87XG4gICAgY2lyY2xlLmFkZENvbXBvbmVudChTaGFwZVJlbmRlcmVyQ29tcG9uZW50LCB7XG4gICAgICAgIHNoYXBlczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgc2l6ZTogMzIsXG4gICAgICAgICAgICAgICAgY29sb3I6IENvbG9yLmJsdWUsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBuZXcgVmVjdG9yMigwLCAwKSxcbiAgICAgICAgICAgICAgICByb3RhdGlvbjogMTgwLFxuICAgICAgICAgICAgICAgIGFyYzogWzAsIDE4MF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgIH0pO1xuICAgIGNpcmNsZS5hZGRDb21wb25lbnQoUm90YXRlQ29tcG9uZW50KTtcbn1cblxuc3RhcnQoKTtcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHQSwwQ0FBbUQsVUFBVTtBQUFBLEVBQ2hELFdBQVc7QUFBQSxJQUNoQixhQUFhO0FBQUEsSUFDYixXQUFXO0FBQUE7QUFBQSxFQUlOLE9BQU8sRUFBRSxhQUFhLGFBQStCLFFBQXNCO0FBQ2hGLFVBQU0sUUFBUSxPQUFPLFNBQVMsU0FBUyxPQUFPLFVBQVUsWUFBYSxhQUFZLE9BQU8sUUFBUTtBQUVoRyxXQUFPLFdBQVcsT0FBTyxTQUFTLEtBQUssT0FBTyxVQUFVLFVBQVU7QUFFbEUsUUFBSSxnQkFBSyxPQUFPO0FBQ1osc0JBQUssT0FBTyxPQUNSLE9BQU8sbUJBQ0gsSUFBSSxRQUFRLElBQUksSUFBSSxNQUFNLGdCQUFLLE9BQU8sVUFFMUMsR0FDQSxRQUFRLEdBQUcsU0FBUyxJQUFJLE9BQU8sT0FBTyxPQUN0QyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBbkJ0Qjs7O0FDQUEsMENBQW1ELFVBQVU7QUFBQSxFQUN2QyxlQUFlLENBQUM7QUFBQSxFQUV6QixXQUFXO0FBQUEsSUFDaEIsT0FBTztBQUFBLElBQ1AsVUFBVTtBQUFBO0FBQUEsRUFHTCxPQUFP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
